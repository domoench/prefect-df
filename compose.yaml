# Docker Compose reference guide at
# https://docs.docker.com/go/compose-spec-reference/

services:
  # PREFECT WORKER
  worker:
    build:
      context: ./services/worker
    env_file:
      - .env
    volumes:
      - ./flows:/opt/prefect/flows
      - ./core:/opt/prefect/core

  # OBJECT STORAGE
  minio:
    build:
      context: ./services/minio
    env_file:
      - .env
    volumes:
      - "minio:/data"
    ports:
      - 9000:9000
      - 9001:9001

  # MLFlow Tracking server
  mlflow:
    build:
      context: ./services/mlflow
    env_file:
      - .env
    ports:
      - 5001:5001

volumes:
  minio:
networks:
  default:
    name: df-network
